The initial problem was to debug the function and find why it was not giving a value.

After looking at the problem I could see that the function was not returning a value.
To rectify this I had to add return into the function. Without a return the function does not know when to exit.